services:
  personal-toolkits:
    build: .
    image: personal-toolkits
    container_name: personal-toolkits
    environment:
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - TZ=America/Chicago
    volumes:
      - /mnt/hgst-1/Twitter:/mnt/Twitter
      - ./.env_jmusk:/app/.env:ro
      - ./token.json:/app/token.json:ro
      - ./sheet-token.json:/app/sheet-token.json:ro
      - ./logs:/tmp
    command: sh -c "python -m scripts.main && crontab /app/crontab && cron -f & tail -F /tmp/cron.log & wait"
    stdin_open: true
    tty: true

  streamlit:
    image: personal-toolkits
    container_name: streamlit-ui
    environment:
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - TZ=America/Chicago
    volumes:
      - /mnt/hgst-1/Twitter:/mnt/Twitter
      - ./.env_jmusk:/app/.env:ro
      - ./token.json:/app/token.json
      - ./sheet-token.json:/app/sheet-token.json
      - ./logs:/tmp
    command: streamlit run app.py --server.port=8501 --server.address=0.0.0.0
    ports:
      - "8501:8501"
    stdin_open: true
    tty: true